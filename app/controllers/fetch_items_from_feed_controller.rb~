class FetchItemsFromFeedController < ApplicationController
  def edit
    feed = Feed.find_by(id: params[:id])
    # τραβά τα άρθρα από τη πηγή και τα καταχωρεί στη βάση
    xml = Feedjira::Feed.fetch_and_parse feed.url
    xml.entries.each do |e|
      item = Entry.find_or_initialize_by(url: e.url)
      if item.new_record?
        item.title = e.title
        item.save
      end
      
      Source.find_or_create_by(feed_id: feed.id, entry_id: item.id)
    end
    redirect_to entries_path
    # παίρνει το id της πηγής και το  id του άρθρου και καταχωρεί στη βάση άρθρο-πηγή
  end
end
